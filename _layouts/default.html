<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{% if page.title == 'Home' %}CTRL - Canadian Tech Rights Lab{% else %}CTRL - {{ page.title }}{% endif %}</title>
    <link rel="stylesheet" href="{{ '/styles.css' | relative_url }}">
  </head>
  <body>
    <!-- Skip navigation for screen readers and keyboard users -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    <a href="#sidebar-nav" class="skip-link">Skip to navigation</a>
    
    <header class="site-header">
      <div class="header-content">
        <div class="ascii-header" id="ascii-header" role="img" aria-label="CTRL Logo">
          <!-- Initial header will be set by JavaScript -->
        </div>
        <!-- Screen reader alternative -->
        <div class="sr-only">
          <h1>CTRL - Canadian Tech Rights Lab</h1>
          <p>Fighting for Canadians' rights in our digital future</p>
        </div>
        <p class="header-text">──[ Canadian Tech Rights Lab ]─────────</p>
      </div>
    </header>

    <!-- Hidden divs containing all ASCII headers -->
    <div id="ascii-headers" style="display: none; position: absolute; left: -9999px;">
      <div class="header">
        <pre><!-- Font: Slant Relief -->
________/\\\\\\\\\__/\\\\\\\\\\\\\\\____/\\\\\\\\\______/\\\_____________        
______/\\\////////__\///////\\\/////___/\\\///////\\\___\/\\\_____________       
_____/\\\/_________________\/\\\_______\/\\\_____\/\\\___\/\\\_____________      
_____/\\\___________________\/\\\_______\/\\\\\\\\\\\/____\/\\\_____________     
_____\/\\\___________________\/\\\_______\/\\\//////\\\____\/\\\_____________    
______\//\\\__________________\/\\\_______\/\\\____\//\\\___\/\\\_____________   
________\///\\\________________\/\\\_______\/\\\_____\//\\\__\/\\\_____________  
___________\////\\\\\\\\\_______\/\\\_______\/\\\______\//\\\_\/\\\\\\\\\\\\\\\_ 
_______________\/////////________\///________\///________\///__\///////////////__</pre>
      </div>
      <div class="header">
        <pre><!-- Font: 3D Diagonal -->
                   ,----,              ,--,    
                 ,/   .`|           ,---.'|    
  ,----..      ,`   .'  : ,-----.   |   | :    
 /   /   \   ;    ;     /'    /  \  :   : |    
|   :     :.'___,/    ,' ;   :    \ |   ' :    
.   |  ;. /|    :     |  |   | .\ : ;   ; '    
.   ; /--` ;    |.';  ;  .   : |: | '   | |__  
;   | ;    `----'  |  |  |   |  \ : |   | :.'| 
|   : |        '   :  ;  |   : .  / '   :    ; 
.   | '___     |   |  '  ;   | |  \ |   |  ./  
'   ; : .'|    '   :  |  |   | ;\  \;   : ;    
'   | '/  :    ;   |.'   :   ' | \.'|   ,/     
|   :    /     '---'     :   : :-'  '---'      
 \   \ .'                |   |.'               
  `---`                  `---'</pre>
      </div>
      <div class="header">
        <pre><!-- Font: 3D-ASCII --> 
 ________ _________  ________  ___          
|\   ____\\___   ___\\   __  \|\  \         
\ \  \___\|___ \  \_\ \  \|\  \ \  \        
 \ \  \       \ \  \ \ \   _  _\ \  \       
  \ \  \____   \ \  \ \ \  \\  \\ \  \____  
   \ \_______\  \ \__\ \ \__\\ _\\ \_______\
    \|_______|   \|__|  \|__|\|__|\|_______|</pre>
      </div>
      <div class="header">
        <pre><!-- Font: Univers -->   
    ,ad8888ba,  888888888888  88888888ba   88           
   d8"'    `"8b      88       88      "8b  88           
  d8'                88       88      ,8P  88           
  88                 88       88aaaaaa8P'  88           
  88                 88       88""""88'    88           
  Y8,                88       88    `8b    88           
   Y8a.    .a8P      88       88     `8b   88           
    `"Y8888Y"'       88       88      `8b  88888888888</pre>
      </div>
      <div class="header">
        <pre><!-- Font: Terrace -->   
   ██████  ██████████ ███████   ██      
  ██░░░░██░░░░░██░░░ ░██░░░░██ ░██      
 ██    ░░     ░██    ░██   ░██ ░██      
░██           ░██    ░███████  ░██      
░██           ░██    ░██░░░██  ░██      
░░██    ██    ░██    ░██  ░░██ ░██      
 ░░██████     ░██    ░██   ░░██░████████
  ░░░░░░      ░░     ░░     ░░ ░░░░░░░░</pre>
      </div>
      <div class="header">
        <pre><!-- Font: ANSI Shadow -->   
   ██████╗████████╗██████╗ ██╗     
  ██╔════╝╚══██╔══╝██╔══██╗██║     
  ██║        ██║   ██████╔╝██║     
  ╚██████╗   ██║   ██║  ██║███████╗
   ╚═════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝</pre>
      </div>
      <div class="header">
        <pre><!-- Font: BlurVision ASCII -->
   ░▒▓██████▓▒░▒▓████████▓▒░▒▓███████▓▒░░▒▓█▓▒░        
  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░        
  ░▒▓█▓▒░        ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░        
  ░▒▓█▓▒░        ░▒▓█▓▒░   ░▒▓███████▓▒░░▒▓█▓▒░        
  ░▒▓█▓▒░        ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░        
  ░▒▓█▓▒░░▒▓█▓▒░ ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓█▓▒░▒▓█▓▒░        
   ░▒▓██████▓▒░  ░▒▓█▓▒░   ░▒▓█▓▒░░▒▓█▓▒░▒▓████████▓▒░           
        </pre>
      </div>
      <div class="header">
        <pre><!-- Font: Poison -->
   @@@@@@@  @@@@@@@  @@@@@@@   @@@       
  @@@@@@@@  @@@@@@@  @@@@@@@@  @@@       
  !@@         @@!    @@!  @@@  @@!       
  !@!         !@!    !@!  @!@  !@!       
  !@!         @!!    @!@!!@!   @!!       
  !!!         !!!    !!@!@!    !!!       
  :!!         !!:    !!: :!!   !!:       
  :!:         :!:    :!:  !:!   :!:      
   ::: :::     ::    ::   :::   :: ::::  
   :: :: :     :      :   : :  : :: : :          
        </pre>
      </div>
      <div class="header">
        <pre><!-- Font: Broadway -->
     ,o888888o. 8888888 8888888888 8 888888888o.   8 8888         
    8888     `88.     8 8888       8 8888    `88.  8 8888         
 ,8 8888       `8.    8 8888       8 8888     `88  8 8888         
 88 8888              8 8888       8 8888     ,88  8 8888         
 88 8888              8 8888       8 8888.   ,88'  8 8888         
 88 8888              8 8888       8 888888888P'   8 8888         
 88 8888              8 8888       8 8888`8b       8 8888         
 `8 8888       .8'    8 8888       8 8888 `8b.     8 8888         
    8888     ,88'     8 8888       8 8888   `8b.   8 8888         
     `8888888P'       8 8888       8 8888     `88. 8 888888888888         
        </pre>
      </div>
      <div class="header">
        <pre><!-- Font: Fraktur -->
               s                       .. 
              :8                 x .d88"  
             .88       .u    .    5888R   
      .     :888ooo  .d88B :@8c   '888R   
 .udR88N  -*8888888 ="8888f8888r   888R   
<888'888k   8888      4888>'88"    888R   
9888 'Y"    8888      4888> '      888R   
9888        8888      4888>        888R   
9888       .8888Lu=  .d888L .+     888R   
?8888u../  ^%888*    ^"8888*"     .888B . 
 "8888P'     'Y"        "Y"       ^*888%  
   "P'                              "%    </pre>
      </div>
      <div class="header">
        <pre><!-- Font: Stellar -->
          `..          `..                  
          `..          `..                  
    `...`.`. `.`. `... `..                  
  `..     `..   `..    `..                  
 `..      `..   `..    `..                  
  `..     `..   `..    `..                  
    `...   `.. `...   `...                               
        </pre>
      </div>
      <div class="header">
        <pre><!-- Font: NScript -->
             I8               ,dPYb,
             I8               IP'`Yb
          88888888            I8  8I
             I8               I8  8'
   ,gggg,    I8     ,gggggg,  I8 dP 
  dP"  "Yb   I8     dP""""8I  I8dP  
 i8'        ,I8,   ,8'    8I  I8P   
,d8,_    _ ,d88b, ,dP     Y8,,d8b,_ 
P""Y8888PP88P""Y888P      `Y88P'"Y88</pre>
      </div>
      <div class="header">
        <pre><!-- Font: Isometric1 -->
     ___           ___           ___           ___ 
    /\  \         /\  \         /\  \         /\__\
   /::\  \        \:\  \       /::\  \       /:/  /
  /:/\:\  \        \:\  \     /:/\:\  \     /:/  / 
 /:/  \:\  \       /::\  \   /::\~\:\  \   /:/  /  
/:/__/ \:\__\     /:/\:\__\ /:/\:\ \:\__\ /:/__/   
\:\  \  \/__/    /:/  \/__/ \/_|::\/:/  / \:\  \   
 \:\  \         /:/  /         |:|::/  /   \:\  \  
  \:\  \        \/__/          |:|\/__/     \:\  \ 
   \:\__\                      |:|  |        \:\__\
    \/__/                       \|__|         \/__/</pre>
      </div>
      <div class="header">
        <pre><!-- Font: Isometric2 -->
     ___                         ___                   
    /\__\                       /\  \                  
   /:/  /          ___         /::\  \                 
  /:/  /          /\__\       /:/\:\__\                
 /:/  /  ___     /:/  /      /:/ /:/  /    ___     ___ 
/:/__/  /\__\   /:/__/      /:/_/:/__/___ /\  \   /\__\
\:\  \ /:/  /  /::\  \      \:\/:::::/  / \:\  \ /:/  /
 \:\  /:/  /  /:/\:\  \      \::/~~/~~~~   \:\  /:/  / 
  \:\/:/  /   \/__\:\  \      \:\~~\        \:\/:/  /  
   \::/  /         \:\__\      \:\__\        \::/  /   
    \/__/           \/__/       \/__/         \/__/    </pre>
      </div>
    </div>

    <div class="container">
      <aside class="sidebar" id="sidebar-nav" role="navigation" aria-label="Site navigation">
        <div class="menu-section">
          <div class="window-title">Projects</div>
          <div class="window-content">
            <div class="ascii-border ascii-border-top">┌────────────────────────────────</div>
            <div class="window-inner">
              <ul>
                {% for project in site.projects %}
                <li><a href="{{ project.url | relative_url }}">[{{ forloop.index }}] {{ project.title }}</a></li>
                {% endfor %}
              </ul>
            </div>
            <div class="ascii-border ascii-border-bottom">└────────────────────────────────</div>
          </div>
        </div>

        <div class="menu-section">
          <div class="window-title">Recent</div>
          <div class="window-content">
            <div class="ascii-border ascii-border-top">┌────────────────────────────────</div>
            <div class="window-inner">
              <ul class="recent-posts">
                {% for post in site.posts limit:5 %}
                <li>
                  <span class="post-date">{{ post.date | date: "%Y-%m-%d" }}</span>
                  <a href="{{ post.url | relative_url }}" class="post-title">[{{ forloop.index | plus: site.projects.size }}] {{ post.title }}</a>
                </li>
                {% endfor %}
              </ul>
            </div>
            <div class="ascii-border ascii-border-bottom">└────────────────────────────────</div>
          </div>
        </div>

        <div class="menu-section">
          <div class="window-title">About</div>
          <div class="window-content">
            <div class="ascii-border ascii-border-top">┌────────────────────────────────</div>
            <div class="window-inner">
              <ul>
                <li>Contact: info [at] takectrl.ca</li>
                <li>Version: 0.9.1</li>
                <li>Updated: {{ site.time | date: "%Y-%m-%d" }}</li>
                <li><a href="{{ '/pages/terms' | relative_url }}">[9] Terms & Privacy</a></li>
              </ul>
            </div>
            <div class="ascii-border ascii-border-bottom">└────────────────────────────────</div>
          </div>
        </div>
      </aside>

      <main class="main-content" id="main-content" role="main">
        <div class="content-window">
          <div class="window-content">
            <div class="window-title">{{ page.title }}</div>
            <div class="ascii-border ascii-border-top">┌────────────────────────────────</div>
            <div class="window-inner">
              <ul>
                {% if page.date %}
                <li><span class="post-date">{{ page.date | date: "%Y-%m-%d" }}</span></li>
                {% endif %}
                {{ content }}
              </ul>
            </div>
            <div class="ascii-border ascii-border-bottom">└────────────────────────────────</div>
          </div>
        </div>
      </main>
    </div>

    <!-- Mobile About section (hidden on desktop) -->
    <div class="mobile-about" style="display: none;">
      <div class="menu-section">
        <div class="window-title">About</div>
        <div class="window-content">
          <div class="ascii-border ascii-border-top">┌────────────────────────────────</div>
          <div class="window-inner">
            <ul>
              <li>Contact: info [at] takectrl.ca</li>
              <li>Version: 0.9.1</li>
              <li>Updated: {{ site.time | date: "%Y-%m-%d" }}</li>
              <li><a href="{{ '/pages/terms' | relative_url }}">[9] Terms & Privacy</a></li>
            </ul>
          </div>
          <div class="ascii-border ascii-border-bottom">└────────────────────────────────</div>
        </div>
      </div>
    </div>

    <footer class="site-footer">
      <div class="footer-content">
        <p>Copyright 2025 Canadian Tech Rights Lab</p>
      </div>
      <button class="theme-toggle" aria-label="Toggle between light and dark mode" aria-pressed="false">[L]ight/Dark</button>
    </footer>

    <script>
      // Initialize theme and ASCII header
      document.addEventListener('DOMContentLoaded', () => {
        if (localStorage.getItem('theme') === 'light') {
          document.body.classList.add('light-mode');
        }
        
        const headers = document.querySelectorAll('#ascii-headers .header');
        const randomIndex = Math.floor(Math.random() * headers.length);
        document.getElementById('ascii-header').innerHTML = headers[randomIndex].innerHTML;
      });

      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        const key = e.key.toLowerCase();
        
        if (key === 'h') {
          // Announce help to screen readers
          const helpText = 'CTRL Help: Use number keys 1-9 to navigate menu items. Press H for help, Q to quit, M for main page, P to go back, L to toggle light/dark mode, R to randomize header.';
          const announcement = document.createElement('div');
          announcement.setAttribute('aria-live', 'assertive');
          announcement.setAttribute('aria-atomic', 'true');
          announcement.className = 'sr-only';
          announcement.textContent = helpText;
          document.body.appendChild(announcement);
          setTimeout(() => document.body.removeChild(announcement), 3000);
          
          alert('CTRL Help\n\nUse number keys to navigate menu items.');
        } else if (key === 'q') {
          if (confirm('Are you sure you want to lose CTRL?')) {
            window.location.href = 'about:blank';
          }
        } else if (key === 'm') {
          window.location.href = '/';
        } else if (key === 'p') {
          window.history.back();
        } else if (key === 'l') {
          document.body.classList.toggle('light-mode');
          localStorage.setItem('theme', document.body.classList.contains('light-mode') ? 'light' : 'dark');
        } else if (key === 'r') {
          const headers = document.querySelectorAll('#ascii-headers .header');
          const randomIndex = Math.floor(Math.random() * headers.length);
          document.getElementById('ascii-header').innerHTML = headers[randomIndex].innerHTML;
        } else if (key >= '1' && key <= '9') {
          const menuItems = document.querySelectorAll('a[href*="/"]');
          const index = parseInt(key) - 1;
          if (menuItems[index]) {
            menuItems[index].click();
          }
        }
      });

      // Theme toggle button with accessibility
      const themeToggle = document.querySelector('.theme-toggle');
      themeToggle.addEventListener('click', () => {
        const isLightMode = document.body.classList.contains('light-mode');
        document.body.classList.toggle('light-mode');
        const newTheme = document.body.classList.contains('light-mode') ? 'light' : 'dark';
        localStorage.setItem('theme', newTheme);
        
        // Update ARIA attributes for screen readers
        themeToggle.setAttribute('aria-pressed', newTheme === 'light' ? 'true' : 'false');
        themeToggle.setAttribute('aria-label', `Currently in ${newTheme} mode. Click to switch to ${newTheme === 'light' ? 'dark' : 'light'} mode.`);
        
        // Announce theme change to screen readers
        const announcement = document.createElement('div');
        announcement.setAttribute('aria-live', 'polite');
        announcement.setAttribute('aria-atomic', 'true');
        announcement.className = 'sr-only';
        announcement.textContent = `Theme switched to ${newTheme} mode`;
        document.body.appendChild(announcement);
        setTimeout(() => document.body.removeChild(announcement), 1000);
      });
    </script>
  </body>
</html> 